import{i as m,j as e,r as g,C as V,B as x,T as l,x as C,w as u,R as F,A as N,G as A,y as P,L as O,t as _,v as Y,z as G,I as K}from"./index-Btm-31DG.js";import{C as S}from"./Card-BDDKMeI0.js";import{C as X}from"./CardContent-Dkq7Cejh.js";import{A as W}from"./Avatar-BAQIQkEy.js";import{C as z}from"./Chip-DUM290oc.js";import{T as q,a as J}from"./Tabs-DE5n_SXU.js";import{T as Q}from"./TextField-CKE8aQ_0.js";import{I as U,S as Z}from"./Search-B6UQiodz.js";import{L as ee}from"./ListItemIcon-BWbTGOf8.js";import{C as oe}from"./People-jG7Zssoj.js";import"./useControlled-Q97ybtUc.js";const re=m(e.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2M9 12c.83 0 1.5.67 1.5 1.5S9.83 15 9 15s-1.5-.67-1.5-1.5S8.17 12 9 12m3 6H6v-.75c0-1 2-1.5 3-1.5s3 .5 3 1.5zm1-9h-2V4h2zm5 7.5h-4V15h4zm0-3h-4V12h4z"}),"Badge"),te=m(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description"),ne=m(e.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download"),L=m(e.jsx("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8z"}),"Folder"),se=m(e.jsx("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz"),ae=m(e.jsx("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd"),H={onboarding:["Test-3.pdf","Test-6.pdf"],client:["Test-1.pdf","Test-6.pdf"],training:["Test-4.pdf","Test-5.pdf"],forms:["Test-2.pdf","Test-6.pdf"]},R={onboarding:new Set,client:new Set,training:new Set,forms:new Set};async function ie(r,t){try{const n=await fetch(`/files/${r}/${t}`,{method:"HEAD",cache:"no-cache"});if(!n.ok)return null;const p=n.headers.get("content-length"),b=n.headers.get("last-modified"),a=h=>{if(!h)return"未知大小";const i=parseInt(h);return i<1024?`${i} B`:i<1024*1024?`${Math.round(i/1024)} KB`:`${(i/(1024*1024)).toFixed(1)} MB`},d=h=>h?new Date(h).toISOString().split("T")[0]:new Date().toISOString().split("T")[0];return{name:t,displayName:t.replace(".pdf",""),size:a(p),date:d(b),category:r,exists:!0,lastModified:b?new Date(b):new Date}}catch(n){return console.error(`获取文件详情失败: ${t}`,n),null}}function le(r){const t=H[r]||[],n=Array.from(R[r]||[]);return[...t,...n]}async function B(r){console.log(`🔍 正在扫描 ${r} 目录...`);const t=[],n=le(r);console.log(`📋 检测 ${n.length} 个可能的文件名: ${n.join(", ")}`);const p=n.map(async a=>await ie(r,a));return(await Promise.all(p)).forEach(a=>{var d;a&&(t.push(a),console.log(`✅ 发现文件: ${a.displayName} (${a.size})`),(d=H[r])!=null&&d.includes(a.name)||R[r].add(a.name))}),t.sort((a,d)=>a.name.localeCompare(d.name)),console.log(`📊 ${r} 目录扫描完成，找到 ${t.length} 个文件`),t}async function ce(){const r=["onboarding","client","training","forms"],t={};console.log("🚀 开始扫描所有文件目录...");for(const p of r)t[p]=await B(p);const n=Object.values(t).reduce((p,b)=>p+b.length,0);return console.log(`🎉 扫描完成！总共找到 ${n} 个文件`),t}async function de(r){return console.log(`🔄 刷新 ${r} 分类...`),await B(r)}const f=[{id:"onboarding",title:"入职文件",description:"新员工入职所需的各类文件和表格",icon:e.jsx(ae,{sx:{fontSize:48}}),color:"#87ceeb",count:2},{id:"client",title:"客户文件",description:"客户服务相关的合同、协议和政策文件",icon:e.jsx(oe,{sx:{fontSize:48}}),color:"#87ceeb",count:1},{id:"training",title:"培训资料",description:"员工培训资料、操作指南和培训手册",icon:e.jsx(re,{sx:{fontSize:48}}),color:"#87ceeb",count:2},{id:"forms",title:"工作表格",description:"日常工作所需的各类表格和记录单",icon:e.jsx(se,{sx:{fontSize:48}}),color:"#87ceeb",count:1}];function Ce(){var I,T;const[r,t]=g.useState(""),[n,p]=g.useState(""),[b,a]=g.useState({}),[d,h]=g.useState(!0),[i,$]=g.useState(!1),[y,j]=g.useState(null),k=async()=>{try{h(!0),j(null),console.log("🔄 开始加载文件...");const o=await ce();a(o),f.forEach(s=>{var c;s.count=((c=o[s.id])==null?void 0:c.length)||0}),console.log("✅ 文件加载完成:",o)}catch(o){console.error("❌ 文件加载失败:",o),j("文件加载失败，请稍后重试")}finally{h(!1)}},D=async o=>{try{$(!0),console.log(`🔄 刷新 ${o} 分类...`);const s=await de(o);a(w=>({...w,[o]:s}));const c=f.find(w=>w.id===o);c&&(c.count=s.length),console.log(`✅ ${o} 分类刷新完成`)}catch(s){console.error(`❌ ${o} 分类刷新失败:`,s),j(`${o} 分类刷新失败`)}finally{$(!1)}};g.useEffect(()=>{k()},[]);const E=(o,s)=>{t(s)},v=((I=b[r])==null?void 0:I.filter(o=>o.name.toLowerCase().includes(n.toLowerCase())||o.displayName&&o.displayName.toLowerCase().includes(n.toLowerCase())))||[],M=o=>{try{const s=`/files/${o.category}/${o.name}`,c=document.createElement("a");c.href=s,c.download=o.name,c.target="_blank",document.body.appendChild(c),c.click(),document.body.removeChild(c),console.log("开始下载文件:",o.displayName||o.name,"路径:",s)}catch(s){console.error("下载失败:",s),alert("下载失败，请稍后重试")}};return e.jsxs(V,{maxWidth:!1,sx:{maxWidth:"1400px",mx:"auto",px:3,py:4},children:[e.jsxs(x,{textAlign:"center",sx:{mb:6},children:[e.jsx(l,{variant:"h2",component:"h1",gutterBottom:!0,children:"Allcare 文档中心"}),e.jsx(l,{variant:"h6",color:"text.secondary",sx:{maxWidth:600,mx:"auto",mb:3},children:"提供护理服务相关的各类文件下载，包括合同文件、政策文件、培训资料和工作表格"}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:2},children:[d&&e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(C,{size:20,sx:{color:"#87ceeb"}}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"正在扫描文件..."})]}),!d&&e.jsx(u,{variant:"outlined",size:"small",startIcon:i?e.jsx(C,{size:16}):e.jsx(F,{}),onClick:k,disabled:i,sx:{borderColor:"#87ceeb",color:"#87ceeb","&:hover":{borderColor:"#87ceeb",backgroundColor:"rgba(135, 206, 235, 0.1)"}},children:i?"刷新中...":"刷新文件列表"})]}),y&&e.jsx(N,{severity:"error",sx:{mt:2,maxWidth:600,mx:"auto"},children:y})]}),e.jsx(A,{container:!0,spacing:4,sx:{mb:6},children:f.map(o=>e.jsx(A,{item:!0,xs:12,sm:6,md:3,children:e.jsx(S,{sx:{height:"100%",cursor:"pointer",transition:"all 0.3s ease-in-out",border:r===o.id?2:0,borderColor:r===o.id?o.color:"transparent",borderRadius:4,background:r===o.id?`linear-gradient(145deg, ${o.color}08, ${o.color}15)`:"linear-gradient(145deg, #ffffff, #f8f9fa)",boxShadow:r===o.id?"0 8px 32px rgba(135, 206, 235, 0.3), 0 4px 16px rgba(135, 206, 235, 0.2)":"0 4px 20px rgba(0, 0, 0, 0.08), 0 2px 8px rgba(0, 0, 0, 0.04)",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"4px",background:`linear-gradient(90deg, ${o.color}, ${o.color}80)`,opacity:r===o.id?1:0,transition:"opacity 0.3s ease"},"&:hover":{transform:"translateY(-8px) scale(1.02)",boxShadow:"0 12px 40px rgba(135, 206, 235, 0.25), 0 6px 20px rgba(135, 206, 235, 0.15)","&::before":{opacity:1}}},onClick:()=>t(o.id),children:e.jsxs(X,{sx:{textAlign:"center",p:3},children:[e.jsx(W,{sx:{width:80,height:80,mx:"auto",mb:2,background:`linear-gradient(145deg, ${o.color}25, ${o.color}15)`,color:o.color,boxShadow:`
                      inset 0 2px 4px rgba(255, 255, 255, 0.8),
                      inset 0 -2px 4px rgba(0, 0, 0, 0.1),
                      0 4px 12px rgba(135, 206, 235, 0.2)
                    `,border:`2px solid ${o.color}30`,transition:"all 0.3s ease",position:"relative","&::before":{content:'""',position:"absolute",top:"10%",left:"10%",width:"30%",height:"30%",background:"rgba(255, 255, 255, 0.3)",borderRadius:"50%",filter:"blur(8px)"}},children:o.icon}),e.jsx(l,{variant:"h5",gutterBottom:!0,children:o.title}),e.jsx(l,{variant:"body2",color:"text.secondary",paragraph:!0,children:o.description}),e.jsx(z,{label:`${o.count} 个文件`,sx:{background:`linear-gradient(145deg, ${o.color}, ${o.color}cc)`,color:"white",fontWeight:600,boxShadow:`
                      0 2px 8px rgba(135, 206, 235, 0.3),
                      inset 0 1px 2px rgba(255, 255, 255, 0.2),
                      inset 0 -1px 2px rgba(0, 0, 0, 0.1)
                    `,border:`1px solid ${o.color}80`,transition:"all 0.3s ease","&:hover":{transform:"scale(1.05)",boxShadow:`
                        0 4px 12px rgba(135, 206, 235, 0.4),
                        inset 0 1px 2px rgba(255, 255, 255, 0.3),
                        inset 0 -1px 2px rgba(0, 0, 0, 0.15)
                      `}}})]})})},o.id))}),e.jsxs(S,{sx:{p:4,borderRadius:4,background:"linear-gradient(145deg, #ffffff, #f8f9fa)",boxShadow:`
          0 8px 32px rgba(0, 0, 0, 0.08),
          0 4px 16px rgba(0, 0, 0, 0.04),
          inset 0 1px 2px rgba(255, 255, 255, 0.8)
        `,border:"1px solid rgba(135, 206, 235, 0.1)"},children:[e.jsxs(x,{sx:{mb:3},children:[e.jsx(q,{value:r||!1,onChange:E,variant:"scrollable",scrollButtons:"auto",sx:{mb:3},children:f.map(o=>e.jsx(J,{label:o.title,value:o.id,icon:P.cloneElement(o.icon,{sx:{fontSize:24}}),iconPosition:"start"},o.id))}),e.jsx(Q,{fullWidth:!0,placeholder:"搜索文件...",value:n,onChange:o=>p(o.target.value),InputProps:{startAdornment:e.jsx(U,{position:"start",children:e.jsx(Z,{})})},sx:{mb:3}})]}),r?e.jsxs(e.Fragment,{children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(l,{variant:"h5",children:(T=f.find(o=>o.id===r))==null?void 0:T.title}),e.jsx(u,{variant:"outlined",size:"small",startIcon:i?e.jsx(C,{size:16}):e.jsx(F,{}),onClick:()=>D(r),disabled:i,sx:{borderColor:"#87ceeb",color:"#87ceeb","&:hover":{borderColor:"#87ceeb",backgroundColor:"rgba(135, 206, 235, 0.1)"}},children:i?"刷新中...":"刷新此分类"})]}),e.jsxs(l,{variant:"body2",color:"text.secondary",sx:{mb:3},children:["共 ",v.length," 个文件 ",d&&"(扫描中...)"]}),e.jsx(O,{children:v.map((o,s)=>e.jsxs(_,{sx:{border:"1px solid rgba(135, 206, 235, 0.15)",borderRadius:3,mb:2,background:"linear-gradient(145deg, #ffffff, #f8f9fa)",boxShadow:`
                      0 2px 8px rgba(0, 0, 0, 0.06),
                      0 1px 4px rgba(0, 0, 0, 0.04),
                      inset 0 1px 1px rgba(255, 255, 255, 0.8)
                    `,transition:"all 0.3s ease",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",left:0,top:0,bottom:0,width:"4px",background:"linear-gradient(180deg, #87ceeb, #87ceeb80)",opacity:0,transition:"opacity 0.3s ease"},"&:hover":{backgroundColor:"rgba(135, 206, 235, 0.05)",transform:"translateX(4px)",boxShadow:`
                        0 4px 16px rgba(135, 206, 235, 0.15),
                        0 2px 8px rgba(135, 206, 235, 0.1),
                        inset 0 1px 2px rgba(255, 255, 255, 0.9)
                      `,"&::before":{opacity:1}}},children:[e.jsx(ee,{children:e.jsx(W,{sx:{background:"linear-gradient(145deg, #87ceeb25, #87ceeb15)",color:"#87ceeb",boxShadow:`
                        inset 0 1px 2px rgba(255, 255, 255, 0.8),
                        inset 0 -1px 2px rgba(0, 0, 0, 0.1),
                        0 2px 6px rgba(135, 206, 235, 0.2)
                      `,border:"1px solid rgba(135, 206, 235, 0.3)",transition:"all 0.3s ease","&:hover":{transform:"scale(1.1)",boxShadow:`
                          inset 0 1px 3px rgba(255, 255, 255, 0.9),
                          inset 0 -1px 3px rgba(0, 0, 0, 0.15),
                          0 4px 12px rgba(135, 206, 235, 0.3)
                        `}},children:e.jsx(te,{})})}),e.jsx(Y,{primary:o.displayName||o.name,secondary:`文件名: ${o.name} | 大小: ${o.size} | 更新时间: ${o.date}`,primaryTypographyProps:{fontWeight:500}}),e.jsx(G,{children:e.jsx(K,{edge:"end",onClick:()=>M(o),sx:{background:"linear-gradient(145deg, #87ceeb, #87ceebcc)",color:"white",boxShadow:`
                          0 3px 12px rgba(135, 206, 235, 0.4),
                          inset 0 1px 2px rgba(255, 255, 255, 0.3),
                          inset 0 -1px 2px rgba(0, 0, 0, 0.1)
                        `,border:"1px solid rgba(135, 206, 235, 0.8)",transition:"all 0.3s ease","&:hover":{background:"linear-gradient(145deg, #87ceebdd, #87ceebaa)",transform:"scale(1.1) translateY(-1px)",boxShadow:`
                            0 6px 20px rgba(135, 206, 235, 0.5),
                            inset 0 1px 3px rgba(255, 255, 255, 0.4),
                            inset 0 -1px 3px rgba(0, 0, 0, 0.15)
                          `},"&:active":{transform:"scale(0.95)",boxShadow:`
                            0 2px 8px rgba(135, 206, 235, 0.3),
                            inset 0 2px 4px rgba(0, 0, 0, 0.2)
                          `}},children:e.jsx(ne,{})})})]},s))}),v.length===0&&e.jsxs(x,{textAlign:"center",sx:{py:4},children:[e.jsx(L,{sx:{fontSize:64,color:"grey.400",mb:2}}),e.jsx(l,{variant:"h6",color:"text.secondary",children:"没有找到相关文件"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"请尝试其他搜索关键词或选择不同的文件类别"})]})]}):e.jsxs(x,{textAlign:"center",sx:{py:8},children:[e.jsx(L,{sx:{fontSize:80,color:"#87ceeb",mb:3}}),e.jsx(l,{variant:"h5",gutterBottom:!0,sx:{color:"#2c3e50",fontWeight:600},children:"请选择文件分类"}),e.jsx(l,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"点击上方的分类卡片或标签页来浏览相应的文件"}),e.jsx(x,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:f.map(o=>e.jsx(u,{variant:"outlined",onClick:()=>t(o.id),sx:{borderColor:o.color,color:o.color,"&:hover":{borderColor:o.color,backgroundColor:`${o.color}10`}},children:o.title},o.id))})]})]}),e.jsx(S,{sx:{mt:6,p:4,textAlign:"center",background:"linear-gradient(135deg, #87ceeb 0%, #87ceeb 100%)",color:"white",borderRadius:4,position:"relative",overflow:"hidden",boxShadow:"0 8px 32px rgba(135, 206, 235, 0.3)","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",pointerEvents:"none"}},children:e.jsxs(x,{sx:{position:"relative",zIndex:1},children:[e.jsx(l,{variant:"h4",gutterBottom:!0,sx:{fontWeight:700},children:"需要文档支持？"}),e.jsx(l,{variant:"h6",sx:{mb:4,opacity:.9,fontWeight:400},children:"如果您找不到需要的文件，或者需要其他文档支持，请联系 Allcare Health Care"}),e.jsxs(x,{sx:{display:"flex",gap:3,justifyContent:"center",flexWrap:"wrap",mb:4},children:[e.jsx(u,{variant:"contained",size:"large",sx:{backgroundColor:"white",color:"#87ceeb",px:4,py:1.5,borderRadius:3,fontWeight:600,textTransform:"none",boxShadow:"0 4px 20px rgba(255, 255, 255, 0.3)","&:hover":{}},children:"联系文档支持"}),e.jsx(u,{variant:"outlined",size:"large",sx:{borderColor:"rgba(255, 255, 255, 0.8)",color:"white",px:4,py:1.5,borderRadius:3,fontWeight:600,textTransform:"none",borderWidth:2,"&:hover":{}},children:"查看客户手册"})]}),e.jsxs(x,{sx:{display:"flex",gap:3,justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(z,{label:"电话: (240) 668-4666",sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white",fontSize:"0.9rem",fontWeight:500,px:2,py:1,borderRadius:3,border:"1px solid rgba(255,255,255,0.3)",backdropFilter:"blur(10px)"}}),e.jsx(z,{label:"邮箱: allcaremd@outlook.com",sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white",fontSize:"0.9rem",fontWeight:500,px:2,py:1,borderRadius:3,border:"1px solid rgba(255,255,255,0.3)",backdropFilter:"blur(10px)"}})]})]})})]})}export{Ce as default};
